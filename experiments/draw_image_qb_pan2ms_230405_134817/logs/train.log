23-04-05 13:48:17.035 - INFO: 首次尝试着色任务，ms2pan的首次尝试。256*256*4->256*256*1
23-04-05 13:48:17.035 - INFO:   name: draw_image_qb_pan2ms
  info: 首次尝试着色任务，ms2pan的首次尝试。256*256*4->256*256*1
  phase: val
  choice: pan2ms
  gpu_ids: [0, 1, 2, 3]
  path:[
    log: experiments\draw_image_qb_pan2ms_230405_134817\logs
    tb_logger: experiments\draw_image_qb_pan2ms_230405_134817\tb_logger
    results: experiments\draw_image_qb_pan2ms_230405_134817\results
    checkpoint: experiments\draw_image_qb_pan2ms_230405_134817\checkpoint
    pan2ms: D:\遥感图像融合\paperwithcode\Image-Super-Resolution-via-Iterative-Refinement-master\experiments\PAN2MS_QB_230314_121358\checkpoint\I4166400_E600
    experiments_root: experiments\draw_image_qb_pan2ms_230405_134817
  ]
  datasets:[
    train:[
      dataroot: E:\data\train_qb_data.h5
      batch_size: 32
      num_workers: 8
      use_shuffle: True
      data_len: -1
    ]
    val:[
      dataroot: E:\UDL\Data\pansharpening\test_data\QB\test_qb_data_RR.h5
      data_len: -1
    ]
  ]
  model:[
    which_model_G: easy
    finetune_norm: False
    init_type: orthogonal
    unet:[
      in_channel: 8
      out_channel: 4
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [32, 64, 128, 256]
      attn_res: []
      res_blocks: 0
      dropout: 0
      num_head_channels: 32
    ]
    beta_schedule:[
      train:[
        schedule: cosine
        n_timestep: 1000
      ]
      val:[
        schedule: cosine
        n_timestep: 1000
      ]
    ]
    diffusion:[
      image_size: 256
      conditional: True
      loss_type: l2
    ]
  ]
  model_fu:[
    spectral_num: 4
  ]
  train:[
    n_epochs: 1000
    val_freq: 100
    save_checkpoint_freq: 100
    print_freq: 1
    optimizer:[
      lr: 0.0003
    ]
  ]
  distributed: True
  log_eval: False

23-04-05 13:48:17.361 - INFO: Initial Dataset Finished
23-04-05 13:48:17.606 - INFO: distributed_training
23-04-05 13:48:17.691 - INFO: Loading pretrained model for G [D:\遥感图像融合\paperwithcode\Image-Super-Resolution-via-Iterative-Refinement-master\experiments\PAN2MS_QB_230314_121358\checkpoint\I4166400_E600] ...
23-04-05 13:48:17.692 - INFO: Network G structure: DataParallel - GaussianDiffusion, with parameters: 1,197,144
23-04-05 13:48:17.692 - INFO: GaussianDiffusion(
  (denoise_fn): Multi_branch_Unet(
    (embed): Sequential(
      (0): Linear(in_features=32, out_features=256, bias=True)
    )
    (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (conv3): Conv2d(4, 32, kernel_size=(3, 3), stride=(1, 1))
    (res1): ResblockDownOne(
      (conv20): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2))
      (dense1): Dense(
        (dense): Linear(in_features=256, out_features=32, bias=True)
      )
      (groupnorm1): GroupNorm(4, 32, eps=1e-05, affine=True)
      (act): SiLU()
    )
    (res3): ResblockDownOne(
      (conv20): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2))
      (dense1): Dense(
        (dense): Linear(in_features=256, out_features=32, bias=True)
      )
      (groupnorm1): GroupNorm(4, 32, eps=1e-05, affine=True)
      (act): SiLU()
    )
    (res4): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (down1): ResblockDownOne(
      (conv20): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2))
      (dense1): Dense(
        (dense): Linear(in_features=256, out_features=64, bias=True)
      )
      (groupnorm1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (act): SiLU()
    )
    (down2): ResblockDownOne(
      (conv20): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2))
      (dense1): Dense(
        (dense): Linear(in_features=256, out_features=128, bias=True)
      )
      (groupnorm1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (act): SiLU()
    )
    (up1): ResblockUpOne(
      (conv20): ConvTranspose2d(256, 128, kernel_size=(3, 3), stride=(2, 2), output_padding=(1, 1))
      (dense1): Dense(
        (dense): Linear(in_features=256, out_features=256, bias=True)
      )
      (groupnorm1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (act): SiLU()
    )
    (dense2): Dense(
      (dense): Linear(in_features=256, out_features=128, bias=True)
    )
    (groupnorm2): GroupNorm(32, 128, eps=1e-05, affine=True)
    (up2): ConvTranspose2d(256, 64, kernel_size=(3, 3), stride=(2, 2), output_padding=(1, 1))
    (dense3): Dense(
      (dense): Linear(in_features=256, out_features=64, bias=True)
    )
    (groupnorm3): GroupNorm(32, 64, eps=1e-05, affine=True)
    (up3): ConvTranspose2d(128, 32, kernel_size=(3, 3), stride=(2, 2), output_padding=(1, 1))
    (dense4): Dense(
      (dense): Linear(in_features=256, out_features=32, bias=True)
    )
    (groupnorm4): GroupNorm(4, 32, eps=1e-05, affine=True)
    (final1): ConvTranspose2d(96, 32, kernel_size=(3, 3), stride=(1, 1))
    (dense5): Dense(
      (dense): Linear(in_features=256, out_features=32, bias=True)
    )
    (groupnorm5): GroupNorm(4, 32, eps=1e-05, affine=True)
    (final2): Conv2d(37, 4, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (act): SiLU()
  )
  (loss_func): MSELoss()
)
23-04-05 13:48:17.692 - INFO: Model [DDPM] is created.
23-04-05 13:48:17.692 - INFO: Initial Model Finished
23-04-05 13:48:17.692 - INFO: Begin Model Evaluation.
